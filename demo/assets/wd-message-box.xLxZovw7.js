import{P as e,r as a,W as l,d as t,q as o,v as s,o as u,c as n,w as r,e as i,n as c,f as v,t as d,p as m,g as p,u as f,F as _,x as w,i as y}from"./index-BYA5EtG0.js";import{M as x,f as b,i as g,k as h,E as k,t as C,b as V}from"./page-wraper.BLx1nEHM.js";import{_ as z}from"./wd-button.Dpaqum9N.js";import{_ as B}from"./wd-input.D8npSRuy.js";import{u as E}from"./useTranslate.CrhsM-8W.js";const I="__MESSAGE_OPTION__",T=Symbol("None"),$={title:"",showCancelButton:!1,show:!1,closeOnClickModal:!0,msg:"",type:"alert",inputType:"text",inputValue:"",inputValidate:null,showErr:!1,zIndex:99,lazyRender:!0,inputError:""};function j(t=""){const o=t?I+t:I,s=e(o,a(T));s.value===T&&(s.value=$,l(o,s));const u=e=>a=>{const l=x({type:e},"string"==typeof a?{title:a}:a);return"confirm"===l.type||"prompt"===l.type?l.showCancelButton=!0:l.showCancelButton=!1,n(l)},n=e=>new Promise(((a,l)=>{const t=x($,"string"==typeof e?{title:e}:e);s.value=x(t,{show:!0,onConfirm:e=>{a(e)},onCancel:e=>{l(e)}})})),r=u("alert"),i=u("confirm"),c=u("prompt");return{show:n,alert:r,confirm:i,prompt:c,close:()=>{s.value!==T&&(s.value.show=!1)}}}const M=V(t({name:"wd-message-box",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...b,selector:g("")},setup(l){const t=l,{translate:x}=E("message-box"),b=o((()=>`wd-message-box__container ${t.customClass}`)),g=o((()=>`wd-message-box__body ${N.value?"":"is-no-title"} ${"prompt"===F.value?"is-prompt":""}`)),V=(T=t.selector)?`${I}${T}`:I;var T;const j=e(V,a($)),M=a("");let P=null,O=null,S=null;const G=a(!1),N=a(""),R=a(!1),U=a(!0),q=a(""),A=a(""),F=a("alert"),H=a("text"),W=a(""),D=a(""),J=a();let K=null;const L=a(""),Q=a(!1),X=a(99),Y=a(!0);function Z(e){if(("modal"!==e||U.value)&&("prompt"!==F.value||"confirm"!==e||function(){if(J.value&&!J.value.test(String(W.value)))return Q.value=!0,!1;if("function"==typeof K){if(!K(W.value))return Q.value=!0,!1}return Q.value=!1,!0}()))switch(e){case"confirm":S?S({resolve:a=>{a&&ee({action:e,value:W.value})}}):ee({action:e,value:W.value});break;case"cancel":ae({action:e});break;default:ae({action:"modal"})}}function ee(e){G.value=!1,k(P)&&P(e)}function ae(e){G.value=!1,k(O)&&O(e)}function le({value:e}){""!==e?W.value=e:Q.value=!1}return s((()=>j.value),(e=>{var a;(a=e)&&(N.value=C(a.title)?a.title:"",R.value=!!C(a.showCancelButton)&&a.showCancelButton,G.value=a.show,U.value=a.closeOnClickModal,q.value=a.confirmButtonText,A.value=a.cancelButtonText,M.value=a.msg,F.value=a.type,H.value=a.inputType,W.value=a.inputValue,D.value=a.inputPlaceholder,J.value=a.inputPattern,K=a.inputValidate,P=a.onConfirm,O=a.onCancel,S=a.beforeConfirm,L.value=a.inputError,Q.value=a.showErr,X.value=a.zIndex,Y.value=a.lazyRender)}),{deep:!0,immediate:!0}),s((()=>G.value),(e=>{!1===e&&(Q.value=!1)}),{deep:!0,immediate:!0}),(e,a)=>{const l=y;return u(),n(l,null,{default:r((()=>[i(h,{transition:"zoom-in",modelValue:G.value,"onUpdate:modelValue":a[3]||(a[3]=e=>G.value=e),"close-on-click-modal":U.value,"lazy-render":Y.value,"custom-class":"wd-message-box",onClickModal:a[4]||(a[4]=e=>Z("modal")),"z-index":X.value,duration:200},{default:r((()=>[i(l,{class:c(b.value)},{default:r((()=>[i(l,{class:c(g.value)},{default:r((()=>[N.value?(u(),n(l,{key:0,class:"wd-message-box__title"},{default:r((()=>[v(d(N.value),1)])),_:1})):m("",!0),i(l,{class:"wd-message-box__content"},{default:r((()=>["prompt"===F.value?(u(),p(_,{key:0},[i(B,{modelValue:W.value,"onUpdate:modelValue":a[0]||(a[0]=e=>W.value=e),type:H.value,size:"large",placeholder:D.value||"请输入",onInput:le},null,8,["modelValue","type","placeholder"]),Q.value?(u(),n(l,{key:0,class:"wd-message-box__input-error"},{default:r((()=>[v(d(L.value||f(x)("inputNoValidate")),1)])),_:1})):m("",!0)],64)):m("",!0),w(e.$slots,"default",{},(()=>[v(d(M.value),1)]),!0)])),_:3})])),_:3},8,["class"]),i(l,{class:c("wd-message-box__actions "+(R.value?"wd-message-box__flex":"wd-message-box__block"))},{default:r((()=>[R.value?(u(),n(z,{key:0,type:"info",block:"","custom-style":"margin-right: 16px;",onClick:a[1]||(a[1]=e=>Z("cancel"))},{default:r((()=>[v(d(A.value||f(x)("cancel")),1)])),_:1})):m("",!0),i(z,{block:"",onClick:a[2]||(a[2]=e=>Z("confirm"))},{default:r((()=>[v(d(q.value||f(x)("confirm")),1)])),_:1})])),_:1},8,["class"])])),_:3},8,["class"])])),_:3},8,["modelValue","close-on-click-modal","lazy-render","z-index"])])),_:3})}}}),[["__scopeId","data-v-604d819a"]]);export{M as _,j as u};
